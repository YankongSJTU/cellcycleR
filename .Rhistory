library(RColorBrewer)
radial.plot(lengths=1:length(out$cell_times),radial.pos=out$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out$cell_times),1], type="l")
plot(cycle_data[,1],type="l")
plot(cycle_data_reorder[order(out$cell_times),7], type="l")
plot(cycle_data[,7],type="l")
plot(cycle_data_reorder[order(out$cell_times),60], type="l")
plot(cycle_data[,60],type="l")
plot(cycle_data_reorder[order(out$cell_times),80], type="l")
plot(cycle_data[,80],type="l")
system.time(out <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=500))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out$cell_times),radial.pos=out$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out$cell_times),1], type="l")
plot(cycle_data[,1],type="l")
plot(cycle_data_reorder[order(out$cell_times),7], type="l")
plot(cycle_data[,7],type="l")
plot(cycle_data_reorder[order(out$cell_times),60], type="l")
plot(cycle_data[,60],type="l")
plot(cycle_data_reorder[order(out$cell_times),80], type="l")
plot(cycle_data[,80],type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 4);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
system.time(out <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 100, num_iter=100))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out$cell_times),radial.pos=out$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out$cell_times),1], type="l")
plot(cycle_data[,1],type="l")
system.time(out <- np_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=100, method="B-spline"))
###### Post processing
plot(sigma_genes, out$sigma, col="red",xlab="true sigma", ylab="est sigma", main="sigma(variation) est, comparison")
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out$cell_times),radial.pos=out$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out$cell_times),30], type="l")
plot(cycle_data[,30],type="l")
system.time(out <- np_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=500, method="B-spline"))
###### Post processing
plot(sigma_genes, out$sigma, col="red",xlab="true sigma", ylab="est sigma", main="sigma(variation) est, comparison")
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out$cell_times),radial.pos=out$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out$cell_times),30], type="l")
plot(cycle_data[,30],type="l")
library(cellcycleR)
library(wavethresh)
library(binhf)
G <- 100;
num_cells <- 256;
phi_genes <- seq(1, pi, length.out=G);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- sort(sample(seq(0,2*pi, 2*pi/(num_cells-1)), num_cells, replace=FALSE));
cycle_data <- matrix(0,num_cells,G)
base <- c(1:(num_cells/4), (num_cells/4):1, 0.2*(1:(num_cells/4))^2, 0.2*((num_cells/4):1))^2);
for(g in 1:G){
cycle_data[,g] <- rnorm(num_cells,shift(base,2*g, dir="right"),sigma_genes[g]);
}
plot(cycle_data[,1], type="l")
plot(cycle_data[,60], type="l")
plot(cycle_data[,30], type="l")
G <- 100;
num_cells <- 256;
phi_genes <- seq(1, pi, length.out=G);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- sort(sample(seq(0,2*pi, 2*pi/(num_cells-1)), num_cells, replace=FALSE));
cycle_data <- matrix(0,num_cells,G)
base <- c(1:(num_cells/4), (num_cells/4):1, 0.2*(1:(num_cells/4))^2, 0.2*((num_cells/4):1)^2);
for(g in 1:G){
cycle_data[,g] <- rnorm(num_cells,shift(base,2*g, dir="right"),sigma_genes[g]);
}
plot(cycle_data[,1], type="l")
plot(cycle_data[,60], type="l")
plot(cycle_data[,30], type="l")
library(cellcycleR)
library(wavethresh)
library(binhf)
G <- 100;
num_cells <- 256;
phi_genes <- seq(1, pi, length.out=G);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- sort(sample(seq(0,2*pi, 2*pi/(num_cells-1)), num_cells, replace=FALSE));
cycle_data <- matrix(0,num_cells,G)
base <- c(1:(num_cells/4), (num_cells/4):1, 0.3*(1:(num_cells/4))^2, 0.3*((num_cells/4):1)^2);
for(g in 1:G){
cycle_data[,g] <- rnorm(num_cells,shift(base,2*g, dir="right"),sigma_genes[g]);
}
plot(cycle_data[,1], type="l")
plot(cycle_data[,60], type="l")
plot(cycle_data[,30], type="l")
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 4);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
pca_cycle
dim(pca_cycle)
pca_cycle$x
dim(pca_cycle$x)
plot(pca_cycle$x[,1], pca_cycle$x[,2])
pca_cycle <- prcomp(cycle_data, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2])
plot(pca_cycle$rotation[,1], pca_cycle$rotation[,2])
length(pca_cycle$rotation[,1])
plot(pca_cycle$rotation[1,], pca_cycle$rotation[2,])
plot(pca_cycle$x[1,], pca_cycle$x[2,])
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[1,], pca_cycle$x[2,])
length(pca_cycle$x[1,])
length(pca_cycle$x[,1])
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,1])
plot(pca_cycle$x[,1], pca_cycle$x[,2])
pca$rotation
pca_cycle$rotation
dim(pca_cycle$rotation)
pca_cycle <- prcomp(t(cycle_data_reorder), center=TRUE, scale. = TRUE);
dim(pca_cycle$rotation)
plot(pca_cycle$rotation[,1], pca_cycle$rotation[,2])
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 64;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 64;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(t(cycle_data_reorder), center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2])
plot(pca_cycle$rotation[,1], pca_cycle$rotation[,2])
dim(cycle_data)
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
plot(cycle_data[,1])
plot(cycle_data[,1], type="l")
pca_cycle <- prcomp(t(cycle_data_reorder), center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2])
plot(pca_cycle$rotation[,1], pca_cycle$rotation[,2])
length(pca_cycle$rotation[,1])
length(pca_cycle$x[,1])
plot(pca_cycle$x[1,], pca_cycle$x[1,])
pca_cycle$x
plot(pca_cycle$x[1,], pca_cycle$x[2,])
pca_cycle$x[2,]
colnames(pca_cycle$x)
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2])
pca_cycle$x[,1]
pca_cycle$x[,2]
plot(pca_cycle$x[,1], pca_cycle$x[,2], type="l")
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.1)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=2)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=10, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=13, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=15, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=16, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=24, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=2, lwd=0.01)
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=200))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out_sinusoidal$cell_times),radial.pos=out_sinusoidal$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out_sinusoidal$cell_times)), lwd=2)
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),1], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),30], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),20], type="l")
cycle_data[,1]
cycle_data[,2]
plot(cycle_data[,2])
plot(cycle_data[,1])
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),60], type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=200))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out_sinusoidal$cell_times),radial.pos=out_sinusoidal$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out_sinusoidal$cell_times)), lwd=2)
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),1], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),60], type="l")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]))
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", type="l")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", type="r")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=12)
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=1)
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=0.5)
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=0.5, cex=1)
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=0.5, cex=1, col="red")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,2]), xlab="sin. cellcycleR rank", ylab="pca 2 rank", pch=20, lwd=0.5, cex=1, col="red")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 4);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 6);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=100))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out_sinusoidal$cell_times),radial.pos=out_sinusoidal$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out_sinusoidal$cell_times)), lwd=2)
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),1], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),60], type="l")
plot(cycle_data[,1], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),60], type="l")
plot(cycle_data[,60], type="l")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=0.5, cex=1, col="red")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,1]), xlab="sin. cellcycleR rank", ylab="pca 1 rank", pch=20, lwd=0.5, cex=1, col="red")
plot(rank(out_sinusoidal$cell_times), rank(pca_cycle$x[,2]), xlab="sin. cellcycleR rank", ylab="pca 2 rank", pch=20, lwd=0.5, cex=1, col="red")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 3);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 2);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 3);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
pca_cycle <- prcomp(cycle_data_reorder, center=TRUE, scale. = TRUE);
plot(pca_cycle$x[,1], pca_cycle$x[,2], pch=20, lwd=0.01)
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=100))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out_sinusoidal$cell_times),radial.pos=out_sinusoidal$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out_sinusoidal$cell_times)), lwd=2)
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),1], type="l")
plot(cycle_data[,1], type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),60], type="l")
plot(cycle_data[,60], type="l")
library(cellcycleR)
devtools::document()
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
mu.est.true <- smooth.spline(cell_times_sim, cycle_data[1,])
plot(cycle_data[,1])
plot(cycle_data[,20])
mu.est.true <- smooth.spline(cell_times_sim, cycle_data[,1])
plot(mu.est.true, type = "l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 512;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
dim(cycle_data)
cycle_data <- cycle_data[1:256,];
plot(cycle_data[,1], type="l")
plot(cycle_data[,20], type="l")
plot(cycle_data[,40], type="l")
mu.est.true <- smooth.spline(cell_times_sim[1:256], cycle_data[,1])
plot(mu.est.true, type = "l")
cycle_data <- cycle_data[1:220,]
plot(cycle_data[,1], type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
cycle_data <- cycle_data[1:220,]
plot(cycle_data[,1], type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
cycle_data <- cycle_data[1:200,]
plot(cycle_data[,1], type="l")
plot(cycle_data[,40], type="l")
mu.est.true <- smooth.spline(cell_times_sim[1:256], cycle_data[,1])
mu.est.true <- smooth.spline(cell_times_sim[1:200], cycle_data[,1])
plot(mu.est.true, type = "l")
rep((3,4,5),2)
rep(c(3,4,5),2)
dupli_response <- rep(cycle_data[,1], 3);
mu.est.dupli <- smooth.spline(rep(cell_times_sim[1:200],3), cycle_data[,1])
mu.est.dupli <- smooth.spline(rep(cell_times_sim[1:200],3), dupli_response)
plot(mu.est.dupli, type="l")
cell_times_sim[1:200]
dupli_response <- rep(cycle_data[,1], 3);
mu.est.dupli <- smooth.spline(c(cell_times_sim[1:200],cell_times_sim[1:200]+2*pi, cell_times_sim[1:200]+4*pi), dupli_response)
plot(mu.est.dupli, type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(10, G);
phi_genes <- rep(c(2,4,6,8), each=G/4);
sigma_genes <- rchisq(G, 0.01);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
levels <- 200
cycle_data <- cycle_data[1:levels,]
plot(cycle_data[,1], type="l")
plot(cycle_data[,40], type="l")
mu.est.true <- smooth.spline(cell_times_sim[1:levels], cycle_data[,1])
plot(mu.est.true, type = "l")
dupli_response <- rep(cycle_data[,1], 3);
mu.est.dupli <- smooth.spline(c(cell_times_sim[1:levels],cell_times_sim[1:levels]+2*pi, cell_times_sim[1:levels]+4*pi), dupli_response)
plot(mu.est.dupli, type="l")
fit <- mu.est.dupli[(levels+1):(2*levels)];
plot(fit, type="l")
fit
length(mu.est.dupli)
levels
2*levels
fit <- mu.est.dupli[(levels+1):(2*levels)];
levels
length(mu.est.dupli)
c(cell_times_sim[1:levels],cell_times_sim[1:levels]+2*pi, cell_times_sim[1:levels]+4*pi)
mu.est.dupli <- smooth.spline(c(cell_times_sim[1:levels],cell_times_sim[1:levels]+2*pi, cell_times_sim[1:levels]+4*pi), dupli_response)
mu.est.dupli
mu.est.dupli$y
fit <- mu.est.dupli$y[(levels+1):(2*levels)];
plot(fit, type="l")
setwd("~/Documents/count-clustering/project/src")
library(data.table)
Data=data.frame(fread("../external_data/Jaitin_Data/GSE54006_umitab.txt"));
gene_names=as.matrix(Data[,1]);
Exp_details=read.table(file="../external_data/Jaitin_Data/jaitin_etal_experimental_design.txt",fill=T,header=T);
##########    extracting the ERCC  genes #########################
ERCC_genes_index=grep("ERCC",gene_names);
Data_non_ERCC=Data[-ERCC_genes_index,];  ###  this is our new Data
counts =t(as.matrix(Data_non_ERCC[,-1]))   ###  extracting only the mRNA counts data (numeric matrix)
dim(counts)
batch_well_ID=colnames(Data_non_ERCC)[-1]
bwlist=strsplit(batch_well_ID,"_");
index_ID = as.numeric(matrix(unlist(bwlist),nrow=2)[2,])
mm = match(index_ID,Exp_details[,1])
Exp_details = Exp_details[mm,]
dim(counts)
dim(Exp_details)
identical(Exp_details[,1],index_ID)
totalcounts = rowSums(counts)
sum(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalcounts > 600 )
filterlist=c("M34473","abParts","M13680","Tmsb4x","S100a4","B2m","Atpase6","Rpl23","Rps18","Rpl13","Rps19","H2-Ab1","Rplp1","Rpl4","Rps26","EF437368")
fcounts = counts[,-match(filterlist,gene_names[-ERCC_genes_index])]
totalfcounts = rowSums(fcounts)
sum(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalfcounts > 600 )
indices=which(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalfcounts > 600);
indices
dim(fcounts)
data <- data.frame(fread('../data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
samples_id=read.table("/Users/kushal/Documents/gtex-viz/gtex.Kushal/data/samples_id.txt")[,3];
brain_indices <- grep("Brain", samples_id);
brain_data <- matdata[,brain_indices];
colnames(brain_data) <- samples_id[brain_indices];
brain_data_frame <- cbind.data.frame(data[,2],brain_data);
data <- data.frame(fread('../external_data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
samples_id=read.table("../external_data/GTEX_V6/samples_id.txt")[,3];
brain_indices <- grep("Brain", samples_id);
brain_data <- matdata[,brain_indices];
colnames(brain_data) <- samples_id[brain_indices];
brain_data_frame <- cbind.data.frame(data[,2],brain_data);
dim(brain_data_frame)
docweights <- as.matrix(read.table('../external_data/GTEX_V6/admix_out_GTEX_V6/omega_cis_genes_brain.txt'));
dim(docweights)
dim(brain_data)
docweights <- as.matrix(read.table("../external_data/GTEX_V6/admix_out_GTEX_V6/omega_cis_genes_0_1_2.txt"));
dim(docweights)
data <- data.frame(fread('../external_data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
dim(matdata)
