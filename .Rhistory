plot(mu.est.dupli, type="l")
fit <- mu.est.dupli[(levels+1):(2*levels)];
plot(fit, type="l")
fit
length(mu.est.dupli)
levels
2*levels
fit <- mu.est.dupli[(levels+1):(2*levels)];
levels
length(mu.est.dupli)
c(cell_times_sim[1:levels],cell_times_sim[1:levels]+2*pi, cell_times_sim[1:levels]+4*pi)
mu.est.dupli <- smooth.spline(c(cell_times_sim[1:levels],cell_times_sim[1:levels]+2*pi, cell_times_sim[1:levels]+4*pi), dupli_response)
mu.est.dupli
mu.est.dupli$y
fit <- mu.est.dupli$y[(levels+1):(2*levels)];
plot(fit, type="l")
setwd("~/Documents/count-clustering/project/src")
library(data.table)
Data=data.frame(fread("../external_data/Jaitin_Data/GSE54006_umitab.txt"));
gene_names=as.matrix(Data[,1]);
Exp_details=read.table(file="../external_data/Jaitin_Data/jaitin_etal_experimental_design.txt",fill=T,header=T);
##########    extracting the ERCC  genes #########################
ERCC_genes_index=grep("ERCC",gene_names);
Data_non_ERCC=Data[-ERCC_genes_index,];  ###  this is our new Data
counts =t(as.matrix(Data_non_ERCC[,-1]))   ###  extracting only the mRNA counts data (numeric matrix)
dim(counts)
batch_well_ID=colnames(Data_non_ERCC)[-1]
bwlist=strsplit(batch_well_ID,"_");
index_ID = as.numeric(matrix(unlist(bwlist),nrow=2)[2,])
mm = match(index_ID,Exp_details[,1])
Exp_details = Exp_details[mm,]
dim(counts)
dim(Exp_details)
identical(Exp_details[,1],index_ID)
totalcounts = rowSums(counts)
sum(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalcounts > 600 )
filterlist=c("M34473","abParts","M13680","Tmsb4x","S100a4","B2m","Atpase6","Rpl23","Rps18","Rpl13","Rps19","H2-Ab1","Rplp1","Rpl4","Rps26","EF437368")
fcounts = counts[,-match(filterlist,gene_names[-ERCC_genes_index])]
totalfcounts = rowSums(fcounts)
sum(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalfcounts > 600 )
indices=which(Exp_details$number_of_cells==1 &  Exp_details$group_name=="CD11c+" & totalfcounts > 600);
indices
dim(fcounts)
data <- data.frame(fread('../data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
samples_id=read.table("/Users/kushal/Documents/gtex-viz/gtex.Kushal/data/samples_id.txt")[,3];
brain_indices <- grep("Brain", samples_id);
brain_data <- matdata[,brain_indices];
colnames(brain_data) <- samples_id[brain_indices];
brain_data_frame <- cbind.data.frame(data[,2],brain_data);
data <- data.frame(fread('../external_data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
samples_id=read.table("../external_data/GTEX_V6/samples_id.txt")[,3];
brain_indices <- grep("Brain", samples_id);
brain_data <- matdata[,brain_indices];
colnames(brain_data) <- samples_id[brain_indices];
brain_data_frame <- cbind.data.frame(data[,2],brain_data);
dim(brain_data_frame)
docweights <- as.matrix(read.table('../external_data/GTEX_V6/admix_out_GTEX_V6/omega_cis_genes_brain.txt'));
dim(docweights)
dim(brain_data)
docweights <- as.matrix(read.table("../external_data/GTEX_V6/admix_out_GTEX_V6/omega_cis_genes_0_1_2.txt"));
dim(docweights)
data <- data.frame(fread('../external_data/GTEX_V6/cis_gene_expression.txt'));
matdata <- data[,-(1:2)];
dim(matdata)
setwd("~/Documents/topotpx-ghpages/project/R")
files <- Sys.glob("../external_data/Dispersion_Fields_No_Abund/");
files
files <- list.files(path=Sys.glob("../external_data/Dispersion_Fields_No_Abund/"));
files
f <- 1
data <- read.csv(files[f]);
data <- read.csv(paste(files[f]));
data <- read.csv(paste0("../",files[f]));
data <- read.csv(paste0("../external_data/",files[f]));
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
dim(data)
data_vec <- matrix(data,nrow(data)*ncol(data),1, byrow=TRUE);
length(data_vec)
matrix(rbind(c(5,6),c(0,8)),1, byrow=TRUE)
map_data <-numeric();
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data_vec <- matrix(data,nrow(data)*ncol(data),1, byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
dim(map_data)
map_data <-numeric();
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data_vec <- matrix(data,1, nrow(data)*ncol(data), byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
dim(map_data)
rownames(map_data)
files
strsplit(files[1])
files[1]
strsplit(files[1],"_")
strsplit(files[1],c("_","."))
strsplit(files[1],"_")[1:2]
strsplit(files[1],"_")[[1]][2][1:2]
strsplit(files[1],"_")[[1]][2]
files
strsplit(files[1],"_")[[1]][2]
strsplit(strsplit(files[1],"_")[[1]][2]," \.")
strsplit(strsplit(files[1],"_")[[1]][2],"[.]")
strsplit(strsplit(files[1],"_")[[1]][2],"[.]")[[1]][1]
lapply(files, function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1]
lapply(files, function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1])
strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1]
lapply(1:length(files), function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1])
unlist(lapply(1:length(files), function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1]))
spots <- unlist(lapply(1:length(files), function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1]))
rownames(map_data) <- spots;
map_data[1:5,1:5]
map_data <-vector(mode = "numeric", length = 0);
map_data <-vector(mode = "numeric", length = 201600);
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data_vec <- matrix(data,1, nrow(data)*ncol(data), byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
map_data <- vector()
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data_vec <- matrix(data,1, nrow(data)*ncol(data), byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
map_data[1:5,1:5]
data_vec[1:5]
files <- list.files(path=Sys.glob("../external_data/Dispersion_Fields_No_Abund/"));
map_data <- vector()
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data[is.na(data)] <- 0;
data_vec <- matrix(data,1, nrow(data)*ncol(data), byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
map_data[1:5,1:5]
data_vec[1:5]
dim(data)
data_vec <- matrix(data,1, nrow(data)*ncol(data), byrow=TRUE);
data_vec[1:5]
data_vec <- as.vector(data,byrow=TRUE);
files <- list.files(path=Sys.glob("../external_data/Dispersion_Fields_No_Abund/"));
map_data <- vector()
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data[is.na(data)] <- 0;
data_vec <- as.vector(data);
map_data <- rbind(map_data, data_vec);
}
data_vec[1:5]
dim(data_vec)
files <- list.files(path=Sys.glob("../external_data/Dispersion_Fields_No_Abund/"));
map_data <- vector()
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data[is.na(data)] <- 0;
dim(data) <- c(1, dim(data)[1]*dim(data)[2])
map_data <- rbind(map_data, data);
}
dim(data)
data[1:5,1:5]
dim(data)[1]*dim(data)[2]
dim(data) <- c(1, dim(data)[1]*dim(data)[2])
dim(data) <- c(dim(data)[1]*dim(data)[2],1)
data_vec <- matrix(data, ncol=dim(data)[1]*dim(data)[2], byrow=TRUE)
dim(data_vec)
map_data <- rbind(map_data, data);
dim(map_data)
map_data <- vector()
map_data <- rbind(map_data, data_vec);
dim(map_data)
map_data[1,1:5]
data_vec[1:5]
data_vec <- matrix(data, ncol=dim(data)[1]*dim(data)[2], byrow=TRUE)
data_vec[1:5]
dim(data_vec)
data_vec[1:5]
data_vec[1:10]
data_vec[1:1000]
data_vec <- as.vector(matrix(data, ncol=dim(data)[1]*dim(data)[2], byrow=TRUE));
data_vec[1:5]
dim(data)[1]*dim(data)[2]
data[1:5,1:5]
dim(data)
data_vec <- matrix(data, ncol=dim(data)[1]*dim(data)[2], byrow=TRUE);
data_vec[1]
dim(data)
class(data)
data_vec <- matrix(as.matrix(data), ncol=dim(data)[1]*dim(data)[2], byrow=TRUE);
data_vec[1:5]
data[1:5,1:5]
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data[is.na(data)] <- 0;
data <- data[,-1];
dim(data)
data[1:5,1:5]
data_vec <- matrix(as.matrix(data), ncol=dim(data)[1]*dim(data)[2], byrow=TRUE);
dim(data_vec)
map_data <- rbind(map_data, data_vec);
map_data <- vector()
map_data <- rbind(map_data, data_vec);
map_data[1,1:5]
files <- list.files(path=Sys.glob("../external_data/Dispersion_Fields_No_Abund/"));
map_data <- vector()
for(f in 1:length(files))
{
data <- read.csv(paste0("../external_data/Dispersion_Fields_No_Abund/",files[f]));
data[is.na(data)] <- 0;
data <- data[,-1];
data_vec <- matrix(as.matrix(data), ncol=dim(data)[1]*dim(data)[2], byrow=TRUE);
map_data <- rbind(map_data, data_vec);
}
spots <- unlist(lapply(1:length(files), function(f) strsplit(strsplit(files[f],"_")[[1]][2],"[.]")[[1]][1]))
rownames(map_data) <- spots;
write.table(map_data, "../external_data/map_data.txt")
write.csv(map_data, "../external_data/map_data.csv")
560*360
map_data <- data.frame(fread('../external_data/map_data.txt'));
library(data.table)
map_data <- data.frame(fread('../external_data/map_data.txt'));
dim(mat_data)
dim(map_data)
map_data[1:5,1:5]
rownames(map_data) <- map_data[,1]
map_data <- map_data[,-1]
dim(map_data)
map_data[1:5,1:5]
class(map_data)
N=360;
M=560;
lat <- rep(1:N, M);
long <- rep(1:M, each=N)
length(lat)
length(long)
smoothScatter(lat, long, map_data[1,])
contourplot(map_data[1,] ~ lat*long)
install.packages("lattice")
library(lattice)
contourplot(map_data[1,] ~ lat*long)
N=360;
M=560;
long <- rep(1:N, M);
lat <- rep(1:M, each=N)
contourplot(map_data[1,] ~ lat*long)
contourplot(map_data[2,] ~ lat*long)
levelplot(map_data[1,] ~ lat*long)
levelplot(map_data[1,] ~ long*lat)
N=360;
M=560;
lat <- rep(1:N, M);
long <- rep(1:M, each=N)
levelplot(map_data[1,] ~ long*lat)
levelplot(map_data[1,] ~ lat*long)
levelplot(map_data[2,] ~ lat*long) ## Second forest spot
Topic_clus <- topics(map_data, K=2, tol=0.01);
library(maptpx)
Topic_clus <- topics(map_data, K=2, tol=0.1);
saveRDS(Topic_clus, "../rdas/topic_clus_2_maps.rds")
metadata=read.csv("../external_data/Himalayan_grid_metadata.csv",header=TRUE);
elevation_metadata=metadata$Elevation[match(rownames(new_counts),metadata[,1])];
elevation_metadata=metadata$Elevation;
elevation_metadata
metadata
metadata[1:3,1:4]
metadata$X
rownames(map_data)
elevation_metadata=metadata$Elevation;
east_west_dir = metadata$WorE[match(rownames(new_counts),metadata[,1])];
east_west_dir = metadata$WorE;
barplot(t(Topic_clus$omega[order(elevation_metadata),]),col=2:(K+1),axisnames=F,space=0,border=NA,main="",las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
title(main=paste("Structure Plot topic proportions,k=",K))
combo_patch_dir = paste0(elevation_metadata,"_",east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(elevation_metadata)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
barplot(t(Topic_clus$omega[order(elevation_metadata),]),col=2:(K+1),axisnames=F,space=0,border=NA,main="",las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
K <- 2
barplot(t(Topic_clus$omega[order(elevation_metadata),]),col=2:(K+1),axisnames=F,space=0,border=NA,main="",las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
title(main=paste("Structure Plot topic proportions,k=",K))
combo_patch_dir = paste0(elevation_metadata);
combo_patch_dir_ordered = combo_patch_dir[order(elevation_metadata)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
round(elevation_metadata)
K <- 2
barplot(t(Topic_clus$omega[order(elevation_metadata),]),col=2:(K+1),axisnames=F,space=0,border=NA,main="",las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4, xlab="elevation")
title(main=paste("Structure Plot topic proportions,k=",K))
combo_patch_dir = paste0(round(elevation_metadata));
combo_patch_dir_ordered = combo_patch_dir[order(elevation_metadata)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
topics_theta <- Topic_clus$theta;
dim(topics_theta)
levelplot(topics_theta[,1] ~ lat*long) ## First forest spot
levelplot(topics_theta[,2] ~ lat*long) ## Second forest spot
Topic_clus <- topics(map_data, K=3, tol=0.1);
docweights <- Topic_clus$omega;
saveRDS(Topic_clus, "../rdas/topic_clus_3_maps.rds")
east_west_dir = metadata$WorE;
barplot(t(docweights[order(east_west_dir),]),col=2:(k+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",k),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(forest_patch_label,"_",east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_dir)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_dir = metadata$WorE;
barplot(t(docweights[order(east_west_dir),]),col=2:(k+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",k),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_dir)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_dir = metadata$WorE;
K <- 3
barplot(t(docweights[order(east_west_dir),]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",k),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_dir)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
east_west_elevation
K <- 3
barplot(t(docweights[order(east_west_dir),]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",k),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_dir)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
barplot(t(docweights[order(east_west_dir),]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",3),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_dir);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_dir)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
barplot(t(docweights[order(east_west_dir),]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",3),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_elevation)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
barplot(t(docweights[order(east_west_elevation),]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",3),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_elevation)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
index1 <- which(metadata$WorE=="E");
index1
index2 <- which(metadata$WorE=="W");
index2
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
order(elevation1)
index <- c(index1[order(elevation1)], index2[order(elevation2)]);
index
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
K <- 3
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",3),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[order(east_west_elevation)];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
K <- 3
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",3),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 4);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
dim(cycle_data)
n_states <- 10;
cell_states <- sapply(1:n_states, function(s) cycle_data[,floor((s*length(cell_times_sim))/n_states])]);
cell_states <- sapply(1:n_states, function(s) cycle_data[,floor((s*length(cell_times_sim))/n_states)]);
s <- 1
floor((s*length(cell_times_sim))/n_states)
floor((10*length(cell_times_sim))/n_states)
cell_states <- sapply(1:n_states, function(s) cycle_data[floor((s*length(cell_times_sim))/n_states),]);
dim(cell_states)
cell_states <- sapply(1:n_states, function(s) floor((s*length(cell_times_sim))/n_states));
cell_states
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 4);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
n_states <- 10;
n_ribo <- 10;
cell_states <- sapply(1:n_states, function(s) floor((s*length(cell_times_sim))/n_states));
for(m in 1:n_states){
for(n in 1:n_ribo){
cycle_data[cell_states[m],n] <- rnorm(1,8,1);
}
}
plot(cycle_data[,2], type="l")
plot(cycle_data[,40], type="l")
library(cellcycleR)
library(wavethresh)
G <- 100;
num_cells <- 256;
amp_genes <- rep(1, G);
phi_genes <- rep(c(2,5), each=G/2);
sigma_genes <- rchisq(G, 1);
cell_times_sim <- seq(0,2*pi, length.out=num_cells);
cycle_data <- sim_sinusoidal_cycle(G, amp_genes, phi_genes, sigma_genes, cell_times_sim);
celltime_levels <- 256;
n_states <- 10;
n_ribo <- 10;
cell_states <- sapply(1:n_states, function(s) floor((s*length(cell_times_sim))/n_states));
for(m in 1:n_states){
for(n in 1:n_ribo){
cycle_data[cell_states[m],n] <- rnorm(1,8,1);
}
}
plot(cycle_data[,2], type="l")
plot(cycle_data[,40], type="l")
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=500))
sample_reorder <- sample(1:num_cells,num_cells, replace=FALSE);
cell_times_reorder <- cell_times_sim[sample_reorder];
cycle_data_reorder <- cycle_data[sample_reorder,];
system.time(out_sinusoidal <- sin_cell_ordering_class(cycle_data_reorder, celltime_levels = 256, num_iter=500))
library(plotrix)
library(RColorBrewer)
radial.plot(lengths=1:length(out_sinusoidal$cell_times),radial.pos=out_sinusoidal$cell_times[order(cell_times_reorder)],
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(out_sinusoidal$cell_times)), lwd=2)
radial.plot(lengths=1:length(cell_times_reorder),radial.pos=sort(cell_times_reorder),
line.col=colorRampPalette(brewer.pal(9,"Blues"))(length(cell_times_reorder)), lwd=2)
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),2], type="l")
plot(cycle_data[,2],type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),30], type="l")
plot(cycle_data[,30],type="l")
plot(cycle_data_reorder[order(out_sinusoidal$cell_times),50], type="l")
plot(cycle_data[,50],type="l")
library(cellcycleR)
devtools::document()
